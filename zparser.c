#ifndef lint
static const char yysccsid[] = "@(#)yaccpar	1.9 (Berkeley) 02/21/93";
#endif

#include <stdlib.h>
#include <string.h>

#define YYBYACC 1
#define YYMAJOR 1
#define YYMINOR 9
#define YYPATCH 20070509

#define YYEMPTY (-1)
#define yyclearin    (yychar = YYEMPTY)
#define yyerrok      (yyerrflag = 0)
#define YYRECOVERING (yyerrflag != 0)

extern int yyparse(void);

static int yygrowstack(void);
#define YYPREFIX "yy"
#line 2 "./zparser.y"
/*
 * zyparser.y -- yacc grammar for (DNS) zone files
 *
 * Copyright (c) 2001-2006, NLnet Labs. All rights reserved.
 *
 * See LICENSE for the license.
 *
 */

#include "config.h"

#include <stdarg.h>
#include <stdio.h>
#include <string.h>

#include "dname.h"
#include "namedb.h"
#include "zonec.h"

/* these need to be global, otherwise they cannot be used inside yacc */
zparser_type *parser;

#ifdef __cplusplus
extern "C"
#endif /* __cplusplus */
int yywrap(void);

/* this hold the nxt bits */
static uint8_t nxtbits[16];
static int dlv_warn = 1;

/* 256 windows of 256 bits (32 bytes) */
/* still need to reset the bastard somewhere */
static uint8_t nsecbits[NSEC_WINDOW_COUNT][NSEC_WINDOW_BITS_SIZE];

/* hold the highest rcode seen in a NSEC rdata , BUG #106 */
uint16_t nsec_highest_rcode;

void yyerror(const char *message);

#ifdef NSEC3
/* parse nsec3 parameters and add the (first) rdata elements */
static void
nsec3_add_params(const char* hash_algo_str, const char* flag_str,
	const char* iter_str, const char* salt_str, int salt_len);
#endif /* NSEC3 */

#line 50 "./zparser.y"
typedef union {
	domain_type	 *domain;
	const dname_type *dname;
	struct lex_data	  data;
	uint32_t	  ttl;
	uint16_t	  klass;
	uint16_t	  type;
	uint16_t	 *unknown;
} YYSTYPE;
#line 81 "zparser.c"
#define T_A 257
#define T_NS 258
#define T_MX 259
#define T_TXT 260
#define T_CNAME 261
#define T_AAAA 262
#define T_PTR 263
#define T_NXT 264
#define T_KEY 265
#define T_SOA 266
#define T_SIG 267
#define T_SRV 268
#define T_CERT 269
#define T_LOC 270
#define T_MD 271
#define T_MF 272
#define T_MB 273
#define T_MG 274
#define T_MR 275
#define T_NULL 276
#define T_WKS 277
#define T_HINFO 278
#define T_MINFO 279
#define T_RP 280
#define T_AFSDB 281
#define T_X25 282
#define T_ISDN 283
#define T_RT 284
#define T_NSAP 285
#define T_NSAP_PTR 286
#define T_PX 287
#define T_GPOS 288
#define T_EID 289
#define T_NIMLOC 290
#define T_ATMA 291
#define T_NAPTR 292
#define T_KX 293
#define T_A6 294
#define T_DNAME 295
#define T_SINK 296
#define T_OPT 297
#define T_APL 298
#define T_UINFO 299
#define T_UID 300
#define T_GID 301
#define T_UNSPEC 302
#define T_TKEY 303
#define T_TSIG 304
#define T_IXFR 305
#define T_AXFR 306
#define T_MAILB 307
#define T_MAILA 308
#define T_DS 309
#define T_DLV 310
#define T_SSHFP 311
#define T_RRSIG 312
#define T_NSEC 313
#define T_DNSKEY 314
#define T_SPF 315
#define T_NSEC3 316
#define T_IPSECKEY 317
#define T_DHCID 318
#define T_NSEC3PARAM 319
#define T_TLSA 320
#define T_NID 321
#define T_L32 322
#define T_L64 323
#define T_LP 324
#define T_EUI48 325
#define T_EUI64 326
#define T_CAA 327
#define DOLLAR_TTL 328
#define DOLLAR_ORIGIN 329
#define NL 330
#define SP 331
#define STR 332
#define PREV 333
#define BITLAB 334
#define T_TTL 335
#define T_RRCLASS 336
#define URR 337
#define T_UTYPE 338
#define YYERRCODE 256
short yylhs[] = {                                        -1,
    0,    0,   18,   18,   18,   18,   18,   18,   18,   19,
   19,   23,   23,   20,   21,   21,   22,    2,    2,   24,
   24,   24,   24,   24,    3,    3,    4,    4,    4,    6,
    6,    5,    5,    7,    7,    8,    8,   10,    9,    9,
   25,   25,   11,   11,   11,   11,   15,   15,   16,   16,
   16,   26,   26,   12,   12,   13,   13,   14,   14,   14,
   14,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,   27,   28,
   29,   30,   31,   32,   33,   34,   35,   36,   37,   38,
   38,   41,   42,   45,   46,   47,   48,   49,   50,   51,
   52,   53,   68,   68,   54,   55,   56,   40,   43,   57,
   58,   59,   60,   44,   69,   39,   39,   61,   62,   63,
   64,   65,   66,   67,   17,   17,   17,
};
short yylen[] = {                                         2,
    0,    2,    1,    2,    2,    1,    1,    1,    2,    1,
    2,    1,    2,    4,    4,    4,    3,    2,    1,    0,
    2,    2,    4,    4,    1,    1,    1,    1,    2,    1,
    1,    1,    3,    1,    1,    1,    2,    1,    1,    3,
    1,    3,    1,    1,    3,    3,    1,    3,    2,    1,
    2,    1,    2,    1,    3,    1,    3,    1,    1,    2,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    2,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    3,    3,
    3,    3,    3,    3,    3,    3,    3,    3,    2,    2,
   14,    6,    4,    4,    4,    2,    4,    4,    2,    2,
    4,    4,    2,    6,    2,    2,    4,    8,   12,    4,
    8,    2,    1,    3,    8,    8,    6,    2,   18,    2,
   10,    8,    8,    8,    7,    4,    2,    4,    4,    4,
    4,    2,    2,    6,    6,    4,    3,
};
short yydefred[] = {                                      1,
    0,    0,    0,    0,    3,   10,   30,    0,   31,   27,
   28,    0,    0,   25,    0,   32,    2,    0,    6,    7,
    8,    9,    0,    0,    5,    0,    0,    0,    0,    0,
    4,   11,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   17,   33,   12,    0,   14,   15,   16,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  132,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   13,    0,    0,   58,    0,
   59,    0,   63,   62,    0,   65,   64,    0,   89,   88,
    0,   91,    0,   90,   71,   70,    0,  117,  116,   83,
   82,    0,  121,  120,    0,  113,  112,    0,   73,   72,
    0,  111,  110,    0,  123,  122,    0,  129,  128,   43,
   44,    0,  119,  118,   67,   66,   69,   68,   75,   74,
   77,   76,   79,   78,    0,   81,   80,    0,   85,   84,
    0,   87,   86,    0,   95,   94,    0,   97,   96,    0,
   99,   98,    0,  101,  100,    0,  107,  106,   56,    0,
  109,  108,    0,  115,  114,    0,  125,  124,    0,  127,
  126,  131,  130,    0,  134,  133,    0,    0,  136,  135,
    0,  138,  137,    0,  140,  139,  142,  141,   38,   36,
    0,   34,    0,   39,  144,  143,  150,  149,   93,   92,
    0,  146,  145,    0,  103,  102,    0,   54,    0,  105,
  104,    0,  148,  147,    0,  152,  151,    0,  154,  153,
    0,  156,  155,    0,  158,  157,    0,  160,  159,    0,
  162,  161,    0,  164,  163,    0,  166,  165,  168,  167,
    0,    0,    0,  169,  170,    0,    0,  176,  185,    0,
    0,    0,    0,    0,    0,    0,    0,  186,    0,    0,
    0,    0,    0,  179,    0,  180,    0,    0,  183,    0,
    0,    0,    0,  192,    0,    0,    0,   52,    0,  200,
    0,    0,    0,    0,  207,    0,  198,    0,    0,    0,
    0,    0,    0,  212,  213,    0,  217,    0,   61,    0,
    0,   47,    0,    0,    0,    0,    0,    0,   46,   45,
    0,    0,    0,    0,    0,    0,    0,   57,    0,    0,
    0,    0,    0,    0,    0,   50,    0,    0,   53,   40,
    0,    0,    0,   55,    0,    0,    0,    0,    0,    0,
    0,    0,  216,  175,    0,  187,    0,    0,    0,    0,
    0,    0,  173,  174,  177,  178,  181,  182,    0,    0,
  190,    0,    0,    0,   49,   51,    0,    0,  206,    0,
    0,  208,  209,  210,  211,    0,    0,   48,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  215,    0,    0,    0,    0,    0,
  172,  184,    0,    0,    0,  197,    0,    0,    0,    0,
  214,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  204,    0,    0,  188,  191,    0,  195,
  196,    0,  202,  203,    0,    0,    0,    0,    0,    0,
    0,  201,    0,    0,    0,    0,    0,  189,    0,    0,
  171,    0,    0,    0,    0,  199,
};
short yydgoto[] = {                                       1,
   92,   12,  165,   14,   15,   16,  271,  272,  273,  274,
  202,  289,  240,  171,  383,  409,  163,   17,   95,   19,
   20,   21,   96,   28,  173,  360,  164,  167,  190,  217,
  220,  223,  170,  174,  226,  229,  232,  235,  286,  291,
  238,  242,  193,  187,  245,  179,  204,  184,  196,  248,
  251,  199,  256,  260,  263,  266,  276,  283,  294,  297,
  300,  303,  306,  309,  312,  315,  318,  257,  287,
};
short yysindex[] = {                                      0,
  107, -319, -299, -299,    0,    0,    0, -294,    0,    0,
    0, -306, -299,    0,   51,    0,    0, -109,    0,    0,
    0,    0,  -80,   60,    0, -299, -299,  637, -226, -310,
    0,    0,  -72,  -72,  -41, -318, -314, -299, -299, -299,
 -299, -299, -299, -299, -299, -299, -299, -299, -299, -299,
 -299, -299, -299, -299, -299, -299, -299, -299, -299, -299,
 -299, -299, -299, -299, -299, -299, -299, -299, -299,  -72,
 -299, -299, -299, -299, -299, -299, -299, -299, -299, -299,
 -299, -299, -299, -299, -299, -299, -299, -299, -299, -148,
 -299,    0,    0,    0,  -65,    0,    0,    0, -299, -299,
  -27,  -36, -237,  -27,  -36,  -27,  -36,  -36, -230,  -36,
 -228, -199, -197,  -19,  -36,  -36,  -36,  -36,  -36,  -27,
 -195,  -36,  -36, -180, -169, -167, -158, -155, -146, -143,
 -134,  -36,  -23,    0, -132, -125, -122, -228,  -15, -230,
  -27, -113, -101,  -98,  -94,  -91,  -82,  -70,  -63,  -56,
  -53,   -7,   -5, -220, -322,    0, -226, -226,    0, -240,
    0,   50,    0,    0,  -72,    0,    0, -299,    0,    0,
   66,    0,  -72,    0,    0,    0,   50,    0,    0,    0,
    0, -299,    0,    0, -299,    0,    0, -299,    0,    0,
 -299,    0,    0, -299,    0,    0, -299,    0,    0,    0,
    0,   70,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  -32,    0,    0, -299,    0,    0,
 -299,    0,    0, -299,    0,    0, -299,    0,    0,  -72,
    0,    0,  -72,    0,    0, -299,    0,    0,    0,   75,
    0,    0, -299,    0,    0, -299,    0,    0, -299,    0,
    0,    0,    0,   66,    0,    0,  -72, -299,    0,    0,
 -299,    0,    0, -299,    0,    0,    0,    0,    0,    0,
   21,    0,   69,    0,    0,    0,    0,    0,    0,    0,
 -299,    0,    0, -299,    0,    0,  -72,    0,  -72,    0,
    0, -299,    0,    0, -299,    0,    0, -299,    0,    0,
 -299,    0,    0, -299,    0,    0, -299,    0,    0,  -72,
    0,    0,  -72,    0,    0, -299,    0,    0,    0,    0,
 -210,    2, -193,    0,    0,   60,  -11,    0,    0,   11,
   26,   60,   37,   41,   85, -191, -183,    0,   87,   90,
   60,   60,   60,    0,    6,    0,   60, -189,    0,   60,
   94,   60,  -11,    0,   97,   99,  101,    0,    9,    0,
 -187,  112,  114,   17,    0,   30,    0,  116,  118,  -39,
  -39,  -39,   60,    0,    0,  121,    0,  -72,    0,  -72,
   66,    0,  -72, -299, -299, -299, -299, -299,    0,    0,
 -299,  -72,  -72,  -72,  -72,  -72,  -72,    0, -299, -299,
  -72,   66, -299, -299, -299,    0,    9,   21,    0,    0,
 -299, -299,  -72,    0, -299, -299,   50,   50,   50,  -72,
 -299,   17,    0,    0,   34,    0,  123,  142,  144,  146,
  148,   43,    0,    0,    0,    0,    0,    0,   60,  153,
    0,  155,  157,  169,    0,    0,  174,  177,    0,  179,
  181,    0,    0,    0,    0,  186,  -72,    0, -299, -299,
 -299, -299, -299,   70,  -72, -299, -299, -299,  -72, -299,
 -299, -299, -299,  -72,    0,  169,  188,  195,   60,  169,
    0,    0,  199,  169,  169,    0,  204,  -39,  206,  169,
    0,  -72, -299, -299,  -72,  -72, -299,  -72,  -72, -299,
   66,  -72,  -72,    0,  208,  210,    0,    0,  212,    0,
    0,  214,    0,    0, -299, -299, -299,   21,  216,  218,
   60,    0, -299, -299,  -72,  220,  222,    0,  -72, -299,
    0,   47, -299,  169,  -72,    0,
};
short yyrindex[] = {                                      0,
    0,    0,    0,    0,    0,    0,    0,  473,    0,    0,
    0,  719,    0,    0,  225,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  555,  227,
    0,    0,    0,    0,    0,  801,  883,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  965, 1047,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  229,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  231,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,  233,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   77,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  235,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  237,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  239,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  245,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,
};
short yygindex[] = {                                      0,
    0,    0,    3,   98,  132,  128, -371,    0,    0, -192,
 -266, -330,    0, -100,    0, -232, 1284,    0,   -1,    0,
    0,    0,  194,    0,    0, -400,    0,   12,    0,    0,
    0,    0,    0,   39,    0,    0,    0,    0,    0,    0,
    0,    0,   40,   52,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,
};
#define YYTABLESIZE 1439
short yytable[] = {                                      18,
  162,   23,   24,   13,   30,  177,  161,  446,   32,   10,
   22,   29,   32,  323,  160,  321,   32,   99,  161,  215,
  100,    7,  161,    9,   36,   37,  201,   11,   26,   27,
  270,    6,  254,  413,  161,   25,  101,  102,  103,  104,
  105,  106,  107,  108,  109,  110,  111,  112,  113,  114,
  115,  116,  117,  118,  119,  120,  121,  122,  123,  124,
  125,  126,  127,  128,  129,  130,  131,  132,  133,  135,
  136,  137,  138,  139,  140,  141,  142,  143,  144,  145,
  146,  147,  148,  149,  150,  151,  152,  153,  201,  155,
    6,  457,  270,   32,  168,  323,   30,  157,  158,  160,
   32,  185,   32,  191,   32,   10,  160,  154,  160,  319,
  182,  323,  188,  469,  361,  336,  176,  522,  181,  377,
  348,   34,   60,   11,  221,  224,  206,  208,  210,  212,
  214,   32,  194,   32,  197,   32,  218,  160,  379,  160,
  389,  160,  398,  253,  269,  492,  156,   32,  390,  496,
   32,  227,   10,  498,  499,   35,  160,   93,  322,  503,
  533,   32,  230,   32,  233,  464,  326,  160,  410,  160,
   11,  327,   32,  236,  445,   32,  239,  268,  160,  280,
  330,  160,    0,  331,   32,  243,  332,   32,  246,  333,
  160,  278,  334,  160,    0,  335,   32,  249,   32,  258,
  337,    0,  160,  535,  160,   32,  261,    0,   32,  264,
    0,  160,    0,  339,  160,    0,  340,   32,  281,  341,
   31,   32,  342,  160,    0,  343,  381,   97,   98,   32,
  284,  345,   32,  288,  347,  160,   32,  292,  160,   32,
  295,  350,  160,    0,  351,  160,    0,  352,   32,  298,
   32,   33,  402,    0,  160,  353,  355,   94,    6,  356,
   32,  301,  357,  134,  156,   32,  160,   32,  304,  417,
  418,  419,    0,  160,   32,  307,    0,   32,  310,  362,
  160,    0,  363,  160,    0,  364,    0,  366,   94,    6,
  368,   32,  159,  369,   32,    7,  370,    9,    6,  371,
  160,    0,  372,   32,  159,  373,  156,   32,  159,  160,
    0,   32,  200,  160,  376,   32,  269,  160,  156,   32,
  159,  160,    0,   32,  313,   32,  316,    0,  380,  160,
    0,  160,   32,  378,  385,  156,   32,  396,  406,  407,
  408,   32,  382,  393,  394,  395,  156,   32,  288,  397,
  358,  359,  399,    0,  401,  324,   32,  384,  325,  156,
   32,  414,    2,  156,   32,  458,  328,   32,  386,    0,
  329,   32,  387,   32,  200,  420,  422,   32,  269,   94,
    6,  425,  427,  428,  429,  430,  431,  501,    0,  432,
   32,    7,    0,    9,    0,  338,    0,  439,  440,   94,
    6,  442,  443,  444,   94,    6,   60,   60,    0,  447,
  448,  366,    0,  450,  451,   32,  388,   32,  391,  456,
   32,  392,    0,  344,   32,  400,  346,   32,  403,   32,
  404,   32,  405,  349,    3,    4,    5,    6,    7,    8,
    9,  465,   32,  411,   32,  412,   32,  415,   32,  416,
  354,   32,  421,   32,  459,  366,    0,  476,  477,  478,
  479,  480,  337,    0,  483,  484,  485,  366,  487,  488,
  489,  490,   32,  460,   32,  461,   32,  462,   32,  463,
  365,  495,  367,   32,  466,   32,  467,   32,  468,    0,
  366,  505,  506,    0,  366,  509,  366,  366,  512,   32,
  288,  366,    0,  374,   32,  470,  375,   32,  471,   32,
  472,   32,  473,  519,  520,  521,   32,  474,   32,  493,
    0,  526,  527,  525,    0,   32,  494,    0,  532,   32,
  497,  534,    0,  366,   32,  500,   32,  502,   32,  515,
   32,  516,   32,  517,   32,  518,   32,  523,   32,  524,
   32,  529,   32,  530,   26,   26,   29,   29,   41,   41,
  193,  193,   35,   35,   37,   37,   42,   42,  194,  194,
    0,  423,    0,  424,  205,  205,  426,    0,    0,    0,
    0,    0,    0,    0,    0,  433,  434,  435,  436,  437,
  438,    0,    0,    0,  441,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  449,    0,    0,    0,
  452,  453,  454,  455,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  475,    0,    0,    0,    0,    0,    0,  481,  482,    0,
    0,    0,  486,    0,    0,    0,    0,  491,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  504,    0,    0,  507,  508,
    0,  510,  511,    0,    0,  513,  514,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  528,    0,
    0,    0,  531,    0,    0,    0,    0,    0,  536,   19,
   19,   19,   19,   19,   19,   19,   19,   19,   19,   19,
   19,   19,   19,   19,   19,   19,   19,   19,    0,   19,
   19,   19,   19,   19,   19,   19,   19,   19,    0,   19,
    0,    0,    0,    0,   19,   19,    0,   19,    0,    0,
   19,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   19,   19,   19,   19,   19,   19,   19,   19,   19,
   19,   19,   19,   19,   19,   19,   19,   19,   19,   19,
    0,    0,    0,    0,   19,    0,    0,   19,   19,    0,
   19,   18,   18,   18,   18,   18,   18,   18,   18,   18,
   18,   18,   18,   18,   18,   18,   18,   18,   18,   18,
    0,   18,   18,   18,   18,   18,   18,   18,   18,   18,
    0,   18,    0,    0,    0,    0,   18,   18,    0,   18,
    0,    0,   18,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   18,   18,   18,   18,   18,   18,   18,
   18,   18,   18,   18,   18,   18,   18,   18,   18,   18,
   18,   18,    0,    0,    0,    0,   18,    0,    0,   18,
   18,    0,   18,   38,   39,   40,   41,   42,   43,   44,
   45,   46,   47,   48,   49,   50,   51,   52,   53,   54,
   55,   56,    0,   57,   58,   59,   60,   61,   62,   63,
   64,   65,    0,   66,    0,    0,    0,    0,   67,   68,
    0,   69,    0,    0,   70,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   71,   72,   73,   74,   75,
   76,   77,   78,   79,   80,   81,   82,   83,   84,   85,
   86,   87,   88,   89,    0,    0,    0,    0,   90,    0,
    0,    0,    0,    0,   91,   20,   20,   20,   20,   20,
   20,   20,   20,   20,   20,   20,   20,   20,   20,   20,
   20,   20,   20,   20,    0,   20,   20,   20,   20,   20,
   20,   20,   20,   20,    0,   20,    0,    0,    0,    0,
   20,   20,    0,   20,    0,    0,   20,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   20,   20,   20,
   20,   20,   20,   20,   20,   20,   20,   20,   20,   20,
   20,   20,   20,   20,   20,   20,    0,    0,    0,    0,
   20,    0,    0,    0,    0,    0,   20,   22,   22,   22,
   22,   22,   22,   22,   22,   22,   22,   22,   22,   22,
   22,   22,   22,   22,   22,   22,    0,   22,   22,   22,
   22,   22,   22,   22,   22,   22,    0,   22,    0,    0,
    0,    0,   22,   22,    0,   22,    0,    0,   22,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   22,
   22,   22,   22,   22,   22,   22,   22,   22,   22,   22,
   22,   22,   22,   22,   22,   22,   22,   22,    0,    0,
    0,    0,   22,    0,    0,    0,    0,    0,   22,   21,
   21,   21,   21,   21,   21,   21,   21,   21,   21,   21,
   21,   21,   21,   21,   21,   21,   21,   21,    0,   21,
   21,   21,   21,   21,   21,   21,   21,   21,    0,   21,
    0,    0,    0,    0,   21,   21,    0,   21,    0,    0,
   21,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   21,   21,   21,   21,   21,   21,   21,   21,   21,
   21,   21,   21,   21,   21,   21,   21,   21,   21,   21,
    0,    0,    0,    0,   21,    0,    0,    0,    0,    0,
   21,   23,   23,   23,   23,   23,   23,   23,   23,   23,
   23,   23,   23,   23,   23,   23,   23,   23,   23,   23,
    0,   23,   23,   23,   23,   23,   23,   23,   23,   23,
    0,   23,    0,    0,    0,    0,   23,   23,    0,   23,
    0,    0,   23,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   23,   23,   23,   23,   23,   23,   23,
   23,   23,   23,   23,   23,   23,   23,   23,   23,   23,
   23,   23,    0,    0,    0,    0,   23,    0,    0,    0,
    0,    0,   23,   24,   24,   24,   24,   24,   24,   24,
   24,   24,   24,   24,   24,   24,   24,   24,   24,   24,
   24,   24,    0,   24,   24,   24,   24,   24,   24,   24,
   24,   24,    0,   24,    0,    0,    0,    0,   24,   24,
    0,   24,    0,    0,   24,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   24,   24,   24,   24,   24,
   24,   24,   24,   24,   24,   24,   24,   24,   24,   24,
   24,   24,   24,   24,    0,    0,    0,    0,   24,    0,
    0,    0,    0,    0,   24,  166,  169,  172,  175,  178,
  180,  183,  186,  189,  192,  195,  198,  203,  205,  207,
  209,  211,  213,  216,  219,  222,  225,  228,  231,  234,
  237,  241,  244,  247,  250,  252,  255,    0,  259,  262,
  265,  267,  275,  277,  279,  282,  285,  290,  293,  296,
  299,  302,  305,  308,  311,  314,  317,    0,  320,
};
short yycheck[] = {                                       1,
  101,    3,    4,    1,   46,  106,   46,  408,  331,   46,
  330,   13,  331,   46,  337,  256,  331,  336,   46,  120,
  335,  332,   46,  334,   26,   27,   46,   64,  335,  336,
   46,  331,  133,  364,   46,  330,   38,   39,   40,   41,
   42,   43,   44,   45,   46,   47,   48,   49,   50,   51,
   52,   53,   54,   55,   56,   57,   58,   59,   60,   61,
   62,   63,   64,   65,   66,   67,   68,   69,   70,   71,
   72,   73,   74,   75,   76,   77,   78,   79,   80,   81,
   82,   83,   84,   85,   86,   87,   88,   89,   46,   91,
  331,  422,   46,  331,  332,   46,   46,   99,  100,  337,
  331,  332,  331,  332,  331,   46,  337,  256,  337,  330,
  108,   46,  110,  444,   46,   46,  105,  518,  107,  330,
   46,   24,   46,   64,  122,  123,  115,  116,  117,  118,
  119,  331,  332,  331,  332,  331,  332,  337,  332,  337,
  332,  337,  332,  132,  332,  476,  330,  331,  332,  480,
  331,  332,   46,  484,  485,   24,  337,   30,  160,  490,
  532,  331,  332,  331,  332,  432,  168,  337,  361,  337,
   64,  173,  331,  332,  407,  331,  332,  138,  337,  141,
  182,  337,   -1,  185,  331,  332,  188,  331,  332,  191,
  337,  140,  194,  337,   -1,  197,  331,  332,  331,  332,
  202,   -1,  337,  534,  337,  331,  332,   -1,  331,  332,
   -1,  337,   -1,  215,  337,   -1,  218,  331,  332,  221,
  330,  331,  224,  337,   -1,  227,  327,   34,   35,  331,
  332,  233,  331,  332,  236,  337,  331,  332,  337,  331,
  332,  243,  337,   -1,  246,  337,   -1,  249,  331,  332,
  331,  332,  353,   -1,  337,  257,  258,  330,  331,  261,
  331,  332,  264,   70,  330,  331,  337,  331,  332,  370,
  371,  372,   -1,  337,  331,  332,   -1,  331,  332,  281,
  337,   -1,  284,  337,   -1,  287,   -1,  289,  330,  331,
  292,  331,  332,  295,  331,  332,  298,  334,  331,  301,
  337,   -1,  304,  331,  332,  307,  330,  331,  332,  337,
   -1,  331,  332,  337,  316,  331,  332,  337,  330,  331,
  332,  337,   -1,  331,  332,  331,  332,   -1,  326,  337,
   -1,  337,  331,  332,  332,  330,  331,  332,  330,  331,
  332,  331,  332,  341,  342,  343,  330,  331,  332,  347,
  330,  331,  350,   -1,  352,  162,  331,  332,  165,  330,
  331,  332,  256,  330,  331,  332,  173,  331,  332,   -1,
  177,  331,  332,  331,  332,  373,  378,  331,  332,  330,
  331,  383,  384,  385,  386,  387,  388,  488,   -1,  391,
  331,  332,   -1,  334,   -1,  202,   -1,  399,  400,  330,
  331,  403,  404,  405,  330,  331,  330,  331,   -1,  411,
  412,  413,   -1,  415,  416,  331,  332,  331,  332,  421,
  331,  332,   -1,  230,  331,  332,  233,  331,  332,  331,
  332,  331,  332,  240,  328,  329,  330,  331,  332,  333,
  334,  439,  331,  332,  331,  332,  331,  332,  331,  332,
  257,  331,  332,  331,  332,  457,   -1,  459,  460,  461,
  462,  463,  464,   -1,  466,  467,  468,  469,  470,  471,
  472,  473,  331,  332,  331,  332,  331,  332,  331,  332,
  287,  479,  289,  331,  332,  331,  332,  331,  332,   -1,
  492,  493,  494,   -1,  496,  497,  498,  499,  500,  331,
  332,  503,   -1,  310,  331,  332,  313,  331,  332,  331,
  332,  331,  332,  515,  516,  517,  331,  332,  331,  332,
   -1,  523,  524,  521,   -1,  331,  332,   -1,  530,  331,
  332,  533,   -1,  535,  331,  332,  331,  332,  331,  332,
  331,  332,  331,  332,  331,  332,  331,  332,  331,  332,
  331,  332,  331,  332,  330,  331,  330,  331,  330,  331,
  330,  331,  330,  331,  330,  331,  330,  331,  330,  331,
   -1,  378,   -1,  380,  330,  331,  383,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  392,  393,  394,  395,  396,
  397,   -1,   -1,   -1,  401,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  413,   -1,   -1,   -1,
  417,  418,  419,  420,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  457,   -1,   -1,   -1,   -1,   -1,   -1,  464,  465,   -1,
   -1,   -1,  469,   -1,   -1,   -1,   -1,  474,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  492,   -1,   -1,  495,  496,
   -1,  498,  499,   -1,   -1,  502,  503,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  525,   -1,
   -1,   -1,  529,   -1,   -1,   -1,   -1,   -1,  535,  257,
  258,  259,  260,  261,  262,  263,  264,  265,  266,  267,
  268,  269,  270,  271,  272,  273,  274,  275,   -1,  277,
  278,  279,  280,  281,  282,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,   -1,  295,   -1,   -1,
  298,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  309,  310,  311,  312,  313,  314,  315,  316,  317,
  318,  319,  320,  321,  322,  323,  324,  325,  326,  327,
   -1,   -1,   -1,   -1,  332,   -1,   -1,  335,  336,   -1,
  338,  257,  258,  259,  260,  261,  262,  263,  264,  265,
  266,  267,  268,  269,  270,  271,  272,  273,  274,  275,
   -1,  277,  278,  279,  280,  281,  282,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,   -1,  295,
   -1,   -1,  298,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  309,  310,  311,  312,  313,  314,  315,
  316,  317,  318,  319,  320,  321,  322,  323,  324,  325,
  326,  327,   -1,   -1,   -1,   -1,  332,   -1,   -1,  335,
  336,   -1,  338,  257,  258,  259,  260,  261,  262,  263,
  264,  265,  266,  267,  268,  269,  270,  271,  272,  273,
  274,  275,   -1,  277,  278,  279,  280,  281,  282,  283,
  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,
   -1,  295,   -1,   -1,  298,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  309,  310,  311,  312,  313,
  314,  315,  316,  317,  318,  319,  320,  321,  322,  323,
  324,  325,  326,  327,   -1,   -1,   -1,   -1,  332,   -1,
   -1,   -1,   -1,   -1,  338,  257,  258,  259,  260,  261,
  262,  263,  264,  265,  266,  267,  268,  269,  270,  271,
  272,  273,  274,  275,   -1,  277,  278,  279,  280,  281,
  282,  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,
  292,  293,   -1,  295,   -1,   -1,  298,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  309,  310,  311,
  312,  313,  314,  315,  316,  317,  318,  319,  320,  321,
  322,  323,  324,  325,  326,  327,   -1,   -1,   -1,   -1,
  332,   -1,   -1,   -1,   -1,   -1,  338,  257,  258,  259,
  260,  261,  262,  263,  264,  265,  266,  267,  268,  269,
  270,  271,  272,  273,  274,  275,   -1,  277,  278,  279,
  280,  281,  282,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,   -1,  295,   -1,   -1,  298,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  309,
  310,  311,  312,  313,  314,  315,  316,  317,  318,  319,
  320,  321,  322,  323,  324,  325,  326,  327,   -1,   -1,
   -1,   -1,  332,   -1,   -1,   -1,   -1,   -1,  338,  257,
  258,  259,  260,  261,  262,  263,  264,  265,  266,  267,
  268,  269,  270,  271,  272,  273,  274,  275,   -1,  277,
  278,  279,  280,  281,  282,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,   -1,  295,   -1,   -1,
  298,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  309,  310,  311,  312,  313,  314,  315,  316,  317,
  318,  319,  320,  321,  322,  323,  324,  325,  326,  327,
   -1,   -1,   -1,   -1,  332,   -1,   -1,   -1,   -1,   -1,
  338,  257,  258,  259,  260,  261,  262,  263,  264,  265,
  266,  267,  268,  269,  270,  271,  272,  273,  274,  275,
   -1,  277,  278,  279,  280,  281,  282,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,   -1,  295,
   -1,   -1,  298,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  309,  310,  311,  312,  313,  314,  315,
  316,  317,  318,  319,  320,  321,  322,  323,  324,  325,
  326,  327,   -1,   -1,   -1,   -1,  332,   -1,   -1,   -1,
   -1,   -1,  338,  257,  258,  259,  260,  261,  262,  263,
  264,  265,  266,  267,  268,  269,  270,  271,  272,  273,
  274,  275,   -1,  277,  278,  279,  280,  281,  282,  283,
  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,
   -1,  295,   -1,   -1,  298,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  309,  310,  311,  312,  313,
  314,  315,  316,  317,  318,  319,  320,  321,  322,  323,
  324,  325,  326,  327,   -1,   -1,   -1,   -1,  332,   -1,
   -1,   -1,   -1,   -1,  338,  102,  103,  104,  105,  106,
  107,  108,  109,  110,  111,  112,  113,  114,  115,  116,
  117,  118,  119,  120,  121,  122,  123,  124,  125,  126,
  127,  128,  129,  130,  131,  132,  133,   -1,  135,  136,
  137,  138,  139,  140,  141,  142,  143,  144,  145,  146,
  147,  148,  149,  150,  151,  152,  153,   -1,  155,
};
#define YYFINAL 1
#ifndef YYDEBUG
#define YYDEBUG 0
#endif
#define YYMAXTOKEN 338
#if YYDEBUG
char *yyname[] = {
"end-of-file",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,"'.'",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"'@'",0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"T_A","T_NS","T_MX",
"T_TXT","T_CNAME","T_AAAA","T_PTR","T_NXT","T_KEY","T_SOA","T_SIG","T_SRV",
"T_CERT","T_LOC","T_MD","T_MF","T_MB","T_MG","T_MR","T_NULL","T_WKS","T_HINFO",
"T_MINFO","T_RP","T_AFSDB","T_X25","T_ISDN","T_RT","T_NSAP","T_NSAP_PTR","T_PX",
"T_GPOS","T_EID","T_NIMLOC","T_ATMA","T_NAPTR","T_KX","T_A6","T_DNAME","T_SINK",
"T_OPT","T_APL","T_UINFO","T_UID","T_GID","T_UNSPEC","T_TKEY","T_TSIG","T_IXFR",
"T_AXFR","T_MAILB","T_MAILA","T_DS","T_DLV","T_SSHFP","T_RRSIG","T_NSEC",
"T_DNSKEY","T_SPF","T_NSEC3","T_IPSECKEY","T_DHCID","T_NSEC3PARAM","T_TLSA",
"T_NID","T_L32","T_L64","T_LP","T_EUI48","T_EUI64","T_CAA","DOLLAR_TTL",
"DOLLAR_ORIGIN","NL","SP","STR","PREV","BITLAB","T_TTL","T_RRCLASS","URR",
"T_UTYPE",
};
char *yyrule[] = {
"$accept : lines",
"lines :",
"lines : lines line",
"line : NL",
"line : sp NL",
"line : PREV NL",
"line : ttl_directive",
"line : origin_directive",
"line : rr",
"line : error NL",
"sp : SP",
"sp : sp SP",
"trail : NL",
"trail : sp NL",
"ttl_directive : DOLLAR_TTL sp STR trail",
"origin_directive : DOLLAR_ORIGIN sp abs_dname trail",
"origin_directive : DOLLAR_ORIGIN sp rel_dname trail",
"rr : owner classttl type_and_rdata",
"owner : dname sp",
"owner : PREV",
"classttl :",
"classttl : T_RRCLASS sp",
"classttl : T_TTL sp",
"classttl : T_TTL sp T_RRCLASS sp",
"classttl : T_RRCLASS sp T_TTL sp",
"dname : abs_dname",
"dname : rel_dname",
"abs_dname : '.'",
"abs_dname : '@'",
"abs_dname : rel_dname '.'",
"label : STR",
"label : BITLAB",
"rel_dname : label",
"rel_dname : rel_dname '.' label",
"wire_dname : wire_abs_dname",
"wire_dname : wire_rel_dname",
"wire_abs_dname : '.'",
"wire_abs_dname : wire_rel_dname '.'",
"wire_label : STR",
"wire_rel_dname : wire_label",
"wire_rel_dname : wire_rel_dname '.' wire_label",
"str_seq : dotted_str",
"str_seq : str_seq sp dotted_str",
"concatenated_str_seq : STR",
"concatenated_str_seq : '.'",
"concatenated_str_seq : concatenated_str_seq sp STR",
"concatenated_str_seq : concatenated_str_seq '.' STR",
"nxt_seq : STR",
"nxt_seq : nxt_seq sp STR",
"nsec_more : SP nsec_more",
"nsec_more : NL",
"nsec_more : STR nsec_seq",
"nsec_seq : NL",
"nsec_seq : SP nsec_more",
"str_sp_seq : STR",
"str_sp_seq : str_sp_seq sp STR",
"str_dot_seq : STR",
"str_dot_seq : str_dot_seq '.' STR",
"dotted_str : STR",
"dotted_str : '.'",
"dotted_str : dotted_str '.'",
"dotted_str : dotted_str '.' STR",
"type_and_rdata : T_A sp rdata_a",
"type_and_rdata : T_A sp rdata_unknown",
"type_and_rdata : T_NS sp rdata_domain_name",
"type_and_rdata : T_NS sp rdata_unknown",
"type_and_rdata : T_MD sp rdata_domain_name",
"type_and_rdata : T_MD sp rdata_unknown",
"type_and_rdata : T_MF sp rdata_domain_name",
"type_and_rdata : T_MF sp rdata_unknown",
"type_and_rdata : T_CNAME sp rdata_domain_name",
"type_and_rdata : T_CNAME sp rdata_unknown",
"type_and_rdata : T_SOA sp rdata_soa",
"type_and_rdata : T_SOA sp rdata_unknown",
"type_and_rdata : T_MB sp rdata_domain_name",
"type_and_rdata : T_MB sp rdata_unknown",
"type_and_rdata : T_MG sp rdata_domain_name",
"type_and_rdata : T_MG sp rdata_unknown",
"type_and_rdata : T_MR sp rdata_domain_name",
"type_and_rdata : T_MR sp rdata_unknown",
"type_and_rdata : T_WKS sp rdata_wks",
"type_and_rdata : T_WKS sp rdata_unknown",
"type_and_rdata : T_PTR sp rdata_domain_name",
"type_and_rdata : T_PTR sp rdata_unknown",
"type_and_rdata : T_HINFO sp rdata_hinfo",
"type_and_rdata : T_HINFO sp rdata_unknown",
"type_and_rdata : T_MINFO sp rdata_minfo",
"type_and_rdata : T_MINFO sp rdata_unknown",
"type_and_rdata : T_MX sp rdata_mx",
"type_and_rdata : T_MX sp rdata_unknown",
"type_and_rdata : T_TXT sp rdata_txt",
"type_and_rdata : T_TXT sp rdata_unknown",
"type_and_rdata : T_SPF sp rdata_txt",
"type_and_rdata : T_SPF sp rdata_unknown",
"type_and_rdata : T_RP sp rdata_rp",
"type_and_rdata : T_RP sp rdata_unknown",
"type_and_rdata : T_AFSDB sp rdata_afsdb",
"type_and_rdata : T_AFSDB sp rdata_unknown",
"type_and_rdata : T_X25 sp rdata_x25",
"type_and_rdata : T_X25 sp rdata_unknown",
"type_and_rdata : T_ISDN sp rdata_isdn",
"type_and_rdata : T_ISDN sp rdata_unknown",
"type_and_rdata : T_IPSECKEY sp rdata_ipseckey",
"type_and_rdata : T_IPSECKEY sp rdata_unknown",
"type_and_rdata : T_DHCID sp rdata_dhcid",
"type_and_rdata : T_DHCID sp rdata_unknown",
"type_and_rdata : T_RT sp rdata_rt",
"type_and_rdata : T_RT sp rdata_unknown",
"type_and_rdata : T_NSAP sp rdata_nsap",
"type_and_rdata : T_NSAP sp rdata_unknown",
"type_and_rdata : T_SIG sp rdata_rrsig",
"type_and_rdata : T_SIG sp rdata_unknown",
"type_and_rdata : T_KEY sp rdata_dnskey",
"type_and_rdata : T_KEY sp rdata_unknown",
"type_and_rdata : T_PX sp rdata_px",
"type_and_rdata : T_PX sp rdata_unknown",
"type_and_rdata : T_AAAA sp rdata_aaaa",
"type_and_rdata : T_AAAA sp rdata_unknown",
"type_and_rdata : T_LOC sp rdata_loc",
"type_and_rdata : T_LOC sp rdata_unknown",
"type_and_rdata : T_NXT sp rdata_nxt",
"type_and_rdata : T_NXT sp rdata_unknown",
"type_and_rdata : T_SRV sp rdata_srv",
"type_and_rdata : T_SRV sp rdata_unknown",
"type_and_rdata : T_NAPTR sp rdata_naptr",
"type_and_rdata : T_NAPTR sp rdata_unknown",
"type_and_rdata : T_KX sp rdata_kx",
"type_and_rdata : T_KX sp rdata_unknown",
"type_and_rdata : T_CERT sp rdata_cert",
"type_and_rdata : T_CERT sp rdata_unknown",
"type_and_rdata : T_DNAME sp rdata_domain_name",
"type_and_rdata : T_DNAME sp rdata_unknown",
"type_and_rdata : T_APL trail",
"type_and_rdata : T_APL sp rdata_apl",
"type_and_rdata : T_APL sp rdata_unknown",
"type_and_rdata : T_DS sp rdata_ds",
"type_and_rdata : T_DS sp rdata_unknown",
"type_and_rdata : T_DLV sp rdata_dlv",
"type_and_rdata : T_DLV sp rdata_unknown",
"type_and_rdata : T_SSHFP sp rdata_sshfp",
"type_and_rdata : T_SSHFP sp rdata_unknown",
"type_and_rdata : T_RRSIG sp rdata_rrsig",
"type_and_rdata : T_RRSIG sp rdata_unknown",
"type_and_rdata : T_NSEC sp rdata_nsec",
"type_and_rdata : T_NSEC sp rdata_unknown",
"type_and_rdata : T_NSEC3 sp rdata_nsec3",
"type_and_rdata : T_NSEC3 sp rdata_unknown",
"type_and_rdata : T_NSEC3PARAM sp rdata_nsec3_param",
"type_and_rdata : T_NSEC3PARAM sp rdata_unknown",
"type_and_rdata : T_DNSKEY sp rdata_dnskey",
"type_and_rdata : T_DNSKEY sp rdata_unknown",
"type_and_rdata : T_TLSA sp rdata_tlsa",
"type_and_rdata : T_TLSA sp rdata_unknown",
"type_and_rdata : T_NID sp rdata_nid",
"type_and_rdata : T_NID sp rdata_unknown",
"type_and_rdata : T_L32 sp rdata_l32",
"type_and_rdata : T_L32 sp rdata_unknown",
"type_and_rdata : T_L64 sp rdata_l64",
"type_and_rdata : T_L64 sp rdata_unknown",
"type_and_rdata : T_LP sp rdata_lp",
"type_and_rdata : T_LP sp rdata_unknown",
"type_and_rdata : T_EUI48 sp rdata_eui48",
"type_and_rdata : T_EUI48 sp rdata_unknown",
"type_and_rdata : T_EUI64 sp rdata_eui64",
"type_and_rdata : T_EUI64 sp rdata_unknown",
"type_and_rdata : T_CAA sp rdata_caa",
"type_and_rdata : T_CAA sp rdata_unknown",
"type_and_rdata : T_UTYPE sp rdata_unknown",
"type_and_rdata : STR error NL",
"rdata_a : dotted_str trail",
"rdata_domain_name : dname trail",
"rdata_soa : dname sp dname sp STR sp STR sp STR sp STR sp STR trail",
"rdata_wks : dotted_str sp STR sp concatenated_str_seq trail",
"rdata_hinfo : STR sp STR trail",
"rdata_minfo : dname sp dname trail",
"rdata_mx : STR sp dname trail",
"rdata_txt : str_seq trail",
"rdata_rp : dname sp dname trail",
"rdata_afsdb : STR sp dname trail",
"rdata_x25 : STR trail",
"rdata_isdn : STR trail",
"rdata_isdn : STR sp STR trail",
"rdata_rt : STR sp dname trail",
"rdata_nsap : str_dot_seq trail",
"rdata_px : STR sp dname sp dname trail",
"rdata_aaaa : dotted_str trail",
"rdata_loc : concatenated_str_seq trail",
"rdata_nxt : dname sp nxt_seq trail",
"rdata_srv : STR sp STR sp STR sp dname trail",
"rdata_naptr : STR sp STR sp STR sp STR sp STR sp dname trail",
"rdata_kx : STR sp dname trail",
"rdata_cert : STR sp STR sp STR sp str_sp_seq trail",
"rdata_apl : rdata_apl_seq trail",
"rdata_apl_seq : dotted_str",
"rdata_apl_seq : rdata_apl_seq sp dotted_str",
"rdata_ds : STR sp STR sp STR sp str_sp_seq trail",
"rdata_dlv : STR sp STR sp STR sp str_sp_seq trail",
"rdata_sshfp : STR sp STR sp str_sp_seq trail",
"rdata_dhcid : str_sp_seq trail",
"rdata_rrsig : STR sp STR sp STR sp STR sp STR sp STR sp STR sp wire_dname sp str_sp_seq trail",
"rdata_nsec : wire_dname nsec_seq",
"rdata_nsec3 : STR sp STR sp STR sp STR sp STR nsec_seq",
"rdata_nsec3_param : STR sp STR sp STR sp STR trail",
"rdata_tlsa : STR sp STR sp STR sp str_sp_seq trail",
"rdata_dnskey : STR sp STR sp STR sp str_sp_seq trail",
"rdata_ipsec_base : STR sp STR sp STR sp dotted_str",
"rdata_ipseckey : rdata_ipsec_base sp str_sp_seq trail",
"rdata_ipseckey : rdata_ipsec_base trail",
"rdata_nid : STR sp dotted_str trail",
"rdata_l32 : STR sp dotted_str trail",
"rdata_l64 : STR sp dotted_str trail",
"rdata_lp : STR sp dname trail",
"rdata_eui48 : STR trail",
"rdata_eui64 : STR trail",
"rdata_caa : STR sp STR sp STR trail",
"rdata_unknown : URR sp STR sp str_sp_seq trail",
"rdata_unknown : URR sp STR trail",
"rdata_unknown : URR error NL",
};
#endif
#if YYDEBUG
#include <stdio.h>
#endif

/* define the initial stack-sizes */
#ifdef YYSTACKSIZE
#undef YYMAXDEPTH
#define YYMAXDEPTH  YYSTACKSIZE
#else
#ifdef YYMAXDEPTH
#define YYSTACKSIZE YYMAXDEPTH
#else
#define YYSTACKSIZE 10000
#define YYMAXDEPTH  10000
#endif
#endif

#define YYINITSTACKSIZE 500

int      yydebug;
int      yynerrs;
int      yyerrflag;
int      yychar;
short   *yyssp;
YYSTYPE *yyvsp;
YYSTYPE  yyval;
YYSTYPE  yylval;

/* variables for the parser stack */
static short   *yyss;
static short   *yysslim;
static YYSTYPE *yyvs;
static int      yystacksize;
#line 1033 "./zparser.y"

int
yywrap(void)
{
	return 1;
}

/*
 * Create the parser.
 */
zparser_type *
zparser_create(region_type *region, region_type *rr_region, namedb_type *db)
{
	zparser_type *result;

	result = (zparser_type *) region_alloc(region, sizeof(zparser_type));
	result->region = region;
	result->rr_region = rr_region;
	result->db = db;

	result->filename = NULL;
	result->current_zone = NULL;
	result->origin = NULL;
	result->prev_dname = NULL;
	result->default_apex = NULL;

	result->temporary_rdatas = (rdata_atom_type *) region_alloc(
		result->region, MAXRDATALEN * sizeof(rdata_atom_type));

	return result;
}

/*
 * Initialize the parser for a new zone file.
 */
void
zparser_init(const char *filename, uint32_t ttl, uint16_t klass,
	     const dname_type *origin)
{
	memset(nxtbits, 0, sizeof(nxtbits));
	memset(nsecbits, 0, sizeof(nsecbits));
        nsec_highest_rcode = 0;

	parser->default_ttl = ttl;
	parser->default_class = klass;
	parser->current_zone = NULL;
	parser->origin = domain_table_insert(parser->db->domains, origin);
	parser->prev_dname = parser->origin;
	parser->default_apex = parser->origin;
	parser->error_occurred = 0;
	parser->errors = 0;
	parser->line = 1;
	parser->filename = filename;
	parser->current_rr.rdata_count = 0;
	parser->current_rr.rdatas = parser->temporary_rdatas;
}

void
yyerror(const char *message)
{
	zc_error("%s", message);
}

static void
error_va_list(unsigned line, const char *fmt, va_list args)
{
	if (parser->filename) {
		char message[MAXSYSLOGMSGLEN];
		vsnprintf(message, sizeof(message), fmt, args);
		log_msg(LOG_ERR, "%s:%u: %s", parser->filename, line, message);
	}
	else log_vmsg(LOG_ERR, fmt, args);

	++parser->errors;
	parser->error_occurred = 1;
}

/* the line counting sux, to say the least
 * with this grose hack we try do give sane
 * numbers back */
void
zc_error_prev_line(const char *fmt, ...)
{
	va_list args;
	va_start(args, fmt);
	error_va_list(parser->line - 1, fmt, args);
	va_end(args);
}

void
zc_error(const char *fmt, ...)
{
	/* send an error message to stderr */
	va_list args;
	va_start(args, fmt);
	error_va_list(parser->line, fmt, args);
	va_end(args);
}

static void
warning_va_list(unsigned line, const char *fmt, va_list args)
{
	if (parser->filename) {
		char m[MAXSYSLOGMSGLEN];
		vsnprintf(m, sizeof(m), fmt, args);
		log_msg(LOG_WARNING, "%s:%u: %s", parser->filename, line, m);
	}
	else log_vmsg(LOG_WARNING, fmt, args);
}

void
zc_warning_prev_line(const char *fmt, ...)
{
	va_list args;
	va_start(args, fmt);
	warning_va_list(parser->line - 1, fmt, args);
	va_end(args);
}

void
zc_warning(const char *fmt, ... )
{
	va_list args;
	va_start(args, fmt);
	warning_va_list(parser->line, fmt, args);
	va_end(args);
}

#ifdef NSEC3
static void
nsec3_add_params(const char* hashalgo_str, const char* flag_str,
	const char* iter_str, const char* salt_str, int salt_len)
{
	zadd_rdata_wireformat(zparser_conv_byte(parser->region, hashalgo_str));
	zadd_rdata_wireformat(zparser_conv_byte(parser->region, flag_str));
	zadd_rdata_wireformat(zparser_conv_short(parser->region, iter_str));

	/* salt */
	if(strcmp(salt_str, "-") != 0) 
		zadd_rdata_wireformat(zparser_conv_hex_length(parser->region, 
			salt_str, salt_len)); 
	else 
		zadd_rdata_wireformat(alloc_rdata_init(parser->region, "", 1));
}
#endif /* NSEC3 */
#line 1117 "zparser.c"
/* allocate initial stack or double stack size, up to YYMAXDEPTH */
static int yygrowstack(void)
{
    int newsize, i;
    short *newss;
    YYSTYPE *newvs;

    if ((newsize = yystacksize) == 0)
        newsize = YYINITSTACKSIZE;
    else if (newsize >= YYMAXDEPTH)
        return -1;
    else if ((newsize *= 2) > YYMAXDEPTH)
        newsize = YYMAXDEPTH;

    i = yyssp - yyss;
    newss = (yyss != 0)
          ? (short *)realloc(yyss, newsize * sizeof(*newss))
          : (short *)malloc(newsize * sizeof(*newss));
    if (newss == 0)
        return -1;

    yyss  = newss;
    yyssp = newss + i;
    newvs = (yyvs != 0)
          ? (YYSTYPE *)realloc(yyvs, newsize * sizeof(*newvs))
          : (YYSTYPE *)malloc(newsize * sizeof(*newvs));
    if (newvs == 0)
        return -1;

    yyvs = newvs;
    yyvsp = newvs + i;
    yystacksize = newsize;
    yysslim = yyss + newsize - 1;
    return 0;
}

#define YYABORT goto yyabort
#define YYREJECT goto yyabort
#define YYACCEPT goto yyaccept
#define YYERROR goto yyerrlab
int
yyparse(void)
{
    register int yym, yyn, yystate;
#if YYDEBUG
    register const char *yys;

    if ((yys = getenv("YYDEBUG")) != 0)
    {
        yyn = *yys;
        if (yyn >= '0' && yyn <= '9')
            yydebug = yyn - '0';
    }
#endif

    yynerrs = 0;
    yyerrflag = 0;
    yychar = YYEMPTY;

    if (yyss == NULL && yygrowstack()) goto yyoverflow;
    yyssp = yyss;
    yyvsp = yyvs;
    *yyssp = yystate = 0;

yyloop:
    if ((yyn = yydefred[yystate]) != 0) goto yyreduce;
    if (yychar < 0)
    {
        if ((yychar = yylex()) < 0) yychar = 0;
#if YYDEBUG
        if (yydebug)
        {
            yys = 0;
            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
            if (!yys) yys = "illegal-symbol";
            printf("%sdebug: state %d, reading %d (%s)\n",
                    YYPREFIX, yystate, yychar, yys);
        }
#endif
    }
    if ((yyn = yysindex[yystate]) && (yyn += yychar) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
    {
#if YYDEBUG
        if (yydebug)
            printf("%sdebug: state %d, shifting to state %d\n",
                    YYPREFIX, yystate, yytable[yyn]);
#endif
        if (yyssp >= yysslim && yygrowstack())
        {
            goto yyoverflow;
        }
        *++yyssp = yystate = yytable[yyn];
        *++yyvsp = yylval;
        yychar = YYEMPTY;
        if (yyerrflag > 0)  --yyerrflag;
        goto yyloop;
    }
    if ((yyn = yyrindex[yystate]) && (yyn += yychar) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
    {
        yyn = yytable[yyn];
        goto yyreduce;
    }
    if (yyerrflag) goto yyinrecovery;

    yyerror("syntax error");

#ifdef lint
    goto yyerrlab;
#endif

yyerrlab:
    ++yynerrs;

yyinrecovery:
    if (yyerrflag < 3)
    {
        yyerrflag = 3;
        for (;;)
        {
            if ((yyn = yysindex[*yyssp]) && (yyn += YYERRCODE) >= 0 &&
                    yyn <= YYTABLESIZE && yycheck[yyn] == YYERRCODE)
            {
#if YYDEBUG
                if (yydebug)
                    printf("%sdebug: state %d, error recovery shifting\
 to state %d\n", YYPREFIX, *yyssp, yytable[yyn]);
#endif
                if (yyssp >= yysslim && yygrowstack())
                {
                    goto yyoverflow;
                }
                *++yyssp = yystate = yytable[yyn];
                *++yyvsp = yylval;
                goto yyloop;
            }
            else
            {
#if YYDEBUG
                if (yydebug)
                    printf("%sdebug: error recovery discarding state %d\n",
                            YYPREFIX, *yyssp);
#endif
                if (yyssp <= yyss) goto yyabort;
                --yyssp;
                --yyvsp;
            }
        }
    }
    else
    {
        if (yychar == 0) goto yyabort;
#if YYDEBUG
        if (yydebug)
        {
            yys = 0;
            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
            if (!yys) yys = "illegal-symbol";
            printf("%sdebug: state %d, error recovery discards token %d (%s)\n",
                    YYPREFIX, yystate, yychar, yys);
        }
#endif
        yychar = YYEMPTY;
        goto yyloop;
    }

yyreduce:
#if YYDEBUG
    if (yydebug)
        printf("%sdebug: state %d, reducing by rule %d (%s)\n",
                YYPREFIX, yystate, yyn, yyrule[yyn]);
#endif
    yym = yylen[yyn];
    if (yym)
        yyval = yyvsp[1-yym];
    else
        memset(&yyval, 0, sizeof yyval);
    switch (yyn)
    {
case 5:
#line 97 "./zparser.y"
{}
break;
case 6:
#line 99 "./zparser.y"
{
	    parser->error_occurred = 0;
    }
break;
case 7:
#line 103 "./zparser.y"
{
	    parser->error_occurred = 0;
    }
break;
case 8:
#line 107 "./zparser.y"
{	/* rr should be fully parsed */
	    if (!parser->error_occurred) {
			    parser->current_rr.rdatas
				    = (rdata_atom_type *) region_alloc_init(
					    parser->region,
					    parser->current_rr.rdatas,
					    (parser->current_rr.rdata_count
					     * sizeof(rdata_atom_type)));

			    process_rr();
	    }

	    region_free_all(parser->rr_region);

	    parser->current_rr.type = 0;
	    parser->current_rr.rdata_count = 0;
	    parser->current_rr.rdatas = parser->temporary_rdatas;
	    parser->error_occurred = 0;
    }
break;
case 14:
#line 139 "./zparser.y"
{
	    parser->default_ttl = zparser_ttl2int(yyvsp[-1].data.str, &(parser->error_occurred));
	    if (parser->error_occurred == 1) {
		    parser->default_ttl = DEFAULT_TTL;
			parser->error_occurred = 0;
	    }
    }
break;
case 15:
#line 149 "./zparser.y"
{
	    /* if previous origin is unused, remove it, do not leak it */
	    domain_table_deldomain(parser->db, parser->origin);
	    parser->origin = yyvsp[-1].domain;
    }
break;
case 16:
#line 155 "./zparser.y"
{
	    zc_error_prev_line("$ORIGIN directive requires absolute domain name");
    }
break;
case 17:
#line 161 "./zparser.y"
{
	    parser->current_rr.owner = yyvsp[-2].domain;
	    parser->current_rr.type = yyvsp[0].type;
    }
break;
case 18:
#line 168 "./zparser.y"
{
	    parser->prev_dname = yyvsp[-1].domain;
	    yyval.domain = yyvsp[-1].domain;
    }
break;
case 19:
#line 173 "./zparser.y"
{
	    yyval.domain = parser->prev_dname;
    }
break;
case 20:
#line 179 "./zparser.y"
{
	    parser->current_rr.ttl = parser->default_ttl;
	    parser->current_rr.klass = parser->default_class;
    }
break;
case 21:
#line 184 "./zparser.y"
{
	    parser->current_rr.ttl = parser->default_ttl;
	    parser->current_rr.klass = yyvsp[-1].klass;
    }
break;
case 22:
#line 189 "./zparser.y"
{
	    parser->current_rr.ttl = yyvsp[-1].ttl;
	    parser->current_rr.klass = parser->default_class;
    }
break;
case 23:
#line 194 "./zparser.y"
{
	    parser->current_rr.ttl = yyvsp[-3].ttl;
	    parser->current_rr.klass = yyvsp[-1].klass;
    }
break;
case 24:
#line 199 "./zparser.y"
{
	    parser->current_rr.ttl = yyvsp[-1].ttl;
	    parser->current_rr.klass = yyvsp[-3].klass;
    }
break;
case 26:
#line 207 "./zparser.y"
{
	    if (yyvsp[0].dname == error_dname) {
		    yyval.domain = error_domain;
	    } else if (yyvsp[0].dname->name_size + domain_dname(parser->origin)->name_size - 1 > MAXDOMAINLEN) {
		    zc_error("domain name exceeds %d character limit", MAXDOMAINLEN);
		    yyval.domain = error_domain;
	    } else {
		    yyval.domain = domain_table_insert(
			    parser->db->domains,
			    dname_concatenate(
				    parser->rr_region,
				    yyvsp[0].dname,
				    domain_dname(parser->origin)));
	    }
    }
break;
case 27:
#line 225 "./zparser.y"
{
	    yyval.domain = parser->db->domains->root;
    }
break;
case 28:
#line 229 "./zparser.y"
{
	    yyval.domain = parser->origin;
    }
break;
case 29:
#line 233 "./zparser.y"
{
	    if (yyvsp[-1].dname != error_dname) {
		    yyval.domain = domain_table_insert(parser->db->domains, yyvsp[-1].dname);
	    } else {
		    yyval.domain = error_domain;
	    }
    }
break;
case 30:
#line 243 "./zparser.y"
{
	    if (yyvsp[0].data.len > MAXLABELLEN) {
		    zc_error("label exceeds %d character limit", MAXLABELLEN);
		    yyval.dname = error_dname;
	    } else if (yyvsp[0].data.len <= 0) {
		    zc_error("zero label length");
		    yyval.dname = error_dname;
	    } else {
		    yyval.dname = dname_make_from_label(parser->rr_region,
					       (uint8_t *) yyvsp[0].data.str,
					       yyvsp[0].data.len);
	    }
    }
break;
case 31:
#line 257 "./zparser.y"
{
	    zc_error("bitlabels are now deprecated. RFC2673 is obsoleted.");
	    yyval.dname = error_dname;
    }
break;
case 33:
#line 265 "./zparser.y"
{
	    if (yyvsp[-2].dname == error_dname || yyvsp[0].dname == error_dname) {
		    yyval.dname = error_dname;
	    } else if (yyvsp[-2].dname->name_size + yyvsp[0].dname->name_size - 1 > MAXDOMAINLEN) {
		    zc_error("domain name exceeds %d character limit",
			     MAXDOMAINLEN);
		    yyval.dname = error_dname;
	    } else {
		    yyval.dname = dname_concatenate(parser->rr_region, yyvsp[-2].dname, yyvsp[0].dname);
	    }
    }
break;
case 36:
#line 287 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region, 2);
	    result[0] = 0;
	    result[1] = '\0';
	    yyval.data.str = result;
	    yyval.data.len = 1;
    }
break;
case 37:
#line 295 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[-1].data.len + 2);
	    memcpy(result, yyvsp[-1].data.str, yyvsp[-1].data.len);
	    result[yyvsp[-1].data.len] = 0;
	    result[yyvsp[-1].data.len+1] = '\0';
	    yyval.data.str = result;
	    yyval.data.len = yyvsp[-1].data.len + 1;
    }
break;
case 38:
#line 307 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[0].data.len + 1);

	    if (yyvsp[0].data.len > MAXLABELLEN)
		    zc_error("label exceeds %d character limit", MAXLABELLEN);

	    /* make label anyway */
	    result[0] = yyvsp[0].data.len;
	    memcpy(result+1, yyvsp[0].data.str, yyvsp[0].data.len);

	    yyval.data.str = result;
	    yyval.data.len = yyvsp[0].data.len + 1;
    }
break;
case 40:
#line 325 "./zparser.y"
{
	    if (yyvsp[-2].data.len + yyvsp[0].data.len - 3 > MAXDOMAINLEN)
		    zc_error("domain name exceeds %d character limit",
			     MAXDOMAINLEN);

	    /* make dname anyway */
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len;
	    yyval.data.str = (char *) region_alloc(parser->rr_region, yyval.data.len + 1);
	    memcpy(yyval.data.str, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    memcpy(yyval.data.str + yyvsp[-2].data.len, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 41:
#line 340 "./zparser.y"
{
	    zadd_rdata_txt_wireformat(zparser_conv_text(parser->rr_region, yyvsp[0].data.str, yyvsp[0].data.len), 1);
    }
break;
case 42:
#line 344 "./zparser.y"
{
	    zadd_rdata_txt_wireformat(zparser_conv_text(parser->rr_region, yyvsp[0].data.str, yyvsp[0].data.len), 0);
    }
break;
case 44:
#line 355 "./zparser.y"
{
	    yyval.data.len = 1;
	    yyval.data.str = region_strdup(parser->rr_region, ".");
    }
break;
case 45:
#line 360 "./zparser.y"
{
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len + 1;
	    yyval.data.str = (char *) region_alloc(parser->rr_region, yyval.data.len + 1);
	    memcpy(yyval.data.str, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    memcpy(yyval.data.str + yyvsp[-2].data.len, " ", 1);
	    memcpy(yyval.data.str + yyvsp[-2].data.len + 1, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 46:
#line 369 "./zparser.y"
{
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len + 1;
	    yyval.data.str = (char *) region_alloc(parser->rr_region, yyval.data.len + 1);
	    memcpy(yyval.data.str, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    memcpy(yyval.data.str + yyvsp[-2].data.len, ".", 1);
	    memcpy(yyval.data.str + yyvsp[-2].data.len + 1, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 47:
#line 381 "./zparser.y"
{
	    uint16_t type = rrtype_from_string(yyvsp[0].data.str);
	    if (type != 0 && type < 128) {
		    set_bit(nxtbits, type);
	    } else {
		    zc_error("bad type %d in NXT record", (int) type);
	    }
    }
break;
case 48:
#line 390 "./zparser.y"
{
	    uint16_t type = rrtype_from_string(yyvsp[0].data.str);
	    if (type != 0 && type < 128) {
		    set_bit(nxtbits, type);
	    } else {
		    zc_error("bad type %d in NXT record", (int) type);
	    }
    }
break;
case 49:
#line 401 "./zparser.y"
{
    }
break;
case 50:
#line 404 "./zparser.y"
{
    }
break;
case 51:
#line 407 "./zparser.y"
{
	    uint16_t type = rrtype_from_string(yyvsp[-1].data.str);
	    if (type != 0) {
                    if (type > nsec_highest_rcode) {
                            nsec_highest_rcode = type;
                    }
		    set_bitnsec(nsecbits, type);
	    } else {
		    zc_error("bad type %d in NSEC record", (int) type);
	    }
    }
break;
case 55:
#line 430 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[-2].data.len + yyvsp[0].data.len + 1);
	    memcpy(result, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    memcpy(result + yyvsp[-2].data.len, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str = result;
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len;
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 57:
#line 447 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[-2].data.len + yyvsp[0].data.len + 1);
	    memcpy(result, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    memcpy(result + yyvsp[-2].data.len, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str = result;
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len;
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 59:
#line 463 "./zparser.y"
{
	yyval.data.str = ".";
	yyval.data.len = 1;
    }
break;
case 60:
#line 468 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[-1].data.len + 2);
	    memcpy(result, yyvsp[-1].data.str, yyvsp[-1].data.len);
	    result[yyvsp[-1].data.len] = '.';
	    yyval.data.str = result;
	    yyval.data.len = yyvsp[-1].data.len + 1;
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 61:
#line 478 "./zparser.y"
{
	    char *result = (char *) region_alloc(parser->rr_region,
						 yyvsp[-2].data.len + yyvsp[0].data.len + 2);
	    memcpy(result, yyvsp[-2].data.str, yyvsp[-2].data.len);
	    result[yyvsp[-2].data.len] = '.';
	    memcpy(result + yyvsp[-2].data.len + 1, yyvsp[0].data.str, yyvsp[0].data.len);
	    yyval.data.str = result;
	    yyval.data.len = yyvsp[-2].data.len + yyvsp[0].data.len + 1;
	    yyval.data.str[yyval.data.len] = '\0';
    }
break;
case 63:
#line 496 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 65:
#line 498 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 66:
#line 499 "./zparser.y"
{ zc_warning_prev_line("MD is obsolete"); }
break;
case 67:
#line 501 "./zparser.y"
{
	    zc_warning_prev_line("MD is obsolete");
	    yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown);
    }
break;
case 68:
#line 505 "./zparser.y"
{ zc_warning_prev_line("MF is obsolete"); }
break;
case 69:
#line 507 "./zparser.y"
{
	    zc_warning_prev_line("MF is obsolete");
	    yyval.type = yyvsp[-2].type;
	    parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown);
    }
break;
case 71:
#line 513 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 73:
#line 515 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 74:
#line 516 "./zparser.y"
{ zc_warning_prev_line("MB is obsolete"); }
break;
case 75:
#line 518 "./zparser.y"
{
	    zc_warning_prev_line("MB is obsolete");
	    yyval.type = yyvsp[-2].type;
	    parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown);
    }
break;
case 77:
#line 524 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 79:
#line 526 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 81:
#line 529 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 83:
#line 531 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 85:
#line 533 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 87:
#line 535 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 89:
#line 537 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 91:
#line 539 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 93:
#line 541 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 95:
#line 543 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 97:
#line 545 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 99:
#line 547 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 101:
#line 549 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 103:
#line 551 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 105:
#line 553 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 107:
#line 555 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 109:
#line 557 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 111:
#line 559 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 113:
#line 561 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 115:
#line 563 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 117:
#line 565 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 119:
#line 567 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 121:
#line 569 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 123:
#line 571 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 125:
#line 573 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 127:
#line 575 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 129:
#line 577 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 131:
#line 579 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 134:
#line 582 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 136:
#line 584 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 137:
#line 585 "./zparser.y"
{ if (dlv_warn) { dlv_warn = 0; zc_warning_prev_line("DLV is experimental"); } }
break;
case 138:
#line 586 "./zparser.y"
{ if (dlv_warn) { dlv_warn = 0; zc_warning_prev_line("DLV is experimental"); } yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 140:
#line 588 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 142:
#line 590 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 144:
#line 592 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 146:
#line 594 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 148:
#line 596 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 150:
#line 598 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 152:
#line 600 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 154:
#line 602 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 156:
#line 604 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 158:
#line 606 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 160:
#line 608 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 162:
#line 610 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 164:
#line 612 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 166:
#line 614 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 167:
#line 615 "./zparser.y"
{ yyval.type = yyvsp[-2].type; parse_unknown_rdata(yyvsp[-2].type, yyvsp[0].unknown); }
break;
case 168:
#line 617 "./zparser.y"
{
	    zc_error_prev_line("unrecognized RR type '%s'", yyvsp[-2].data.str);
    }
break;
case 169:
#line 629 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_a(parser->region, yyvsp[-1].data.str));
    }
break;
case 170:
#line 635 "./zparser.y"
{
	    /* convert a single dname record */
	    zadd_rdata_domain(yyvsp[-1].domain);
    }
break;
case 171:
#line 642 "./zparser.y"
{
	    /* convert the soa data */
	    zadd_rdata_domain(yyvsp[-13].domain);	/* prim. ns */
	    zadd_rdata_domain(yyvsp[-11].domain);	/* email */
	    zadd_rdata_wireformat(zparser_conv_serial(parser->region, yyvsp[-9].data.str)); /* serial */
	    zadd_rdata_wireformat(zparser_conv_period(parser->region, yyvsp[-7].data.str)); /* refresh */
	    zadd_rdata_wireformat(zparser_conv_period(parser->region, yyvsp[-5].data.str)); /* retry */
	    zadd_rdata_wireformat(zparser_conv_period(parser->region, yyvsp[-3].data.str)); /* expire */
	    zadd_rdata_wireformat(zparser_conv_period(parser->region, yyvsp[-1].data.str)); /* minimum */
    }
break;
case 172:
#line 655 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_a(parser->region, yyvsp[-5].data.str)); /* address */
	    zadd_rdata_wireformat(zparser_conv_services(parser->region, yyvsp[-3].data.str, yyvsp[-1].data.str)); /* protocol and services */
    }
break;
case 173:
#line 662 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-3].data.str, yyvsp[-3].data.len)); /* CPU */
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* OS*/
    }
break;
case 174:
#line 669 "./zparser.y"
{
	    /* convert a single dname record */
	    zadd_rdata_domain(yyvsp[-3].domain);
	    zadd_rdata_domain(yyvsp[-1].domain);
    }
break;
case 175:
#line 677 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str));  /* priority */
	    zadd_rdata_domain(yyvsp[-1].domain);	/* MX host */
    }
break;
case 176:
#line 684 "./zparser.y"
{
	zadd_rdata_txt_clean_wireformat();
    }
break;
case 177:
#line 691 "./zparser.y"
{
	    zadd_rdata_domain(yyvsp[-3].domain); /* mbox d-name */
	    zadd_rdata_domain(yyvsp[-1].domain); /* txt d-name */
    }
break;
case 178:
#line 699 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str)); /* subtype */
	    zadd_rdata_domain(yyvsp[-1].domain); /* domain name */
    }
break;
case 179:
#line 707 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* X.25 address. */
    }
break;
case 180:
#line 714 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* address */
    }
break;
case 181:
#line 718 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-3].data.str, yyvsp[-3].data.len)); /* address */
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* sub-address */
    }
break;
case 182:
#line 726 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str)); /* preference */
	    zadd_rdata_domain(yyvsp[-1].domain); /* intermediate host */
    }
break;
case 183:
#line 734 "./zparser.y"
{
	    /* String must start with "0x" or "0X".	 */
	    if (strncasecmp(yyvsp[-1].data.str, "0x", 2) != 0) {
		    zc_error_prev_line("NSAP rdata must start with '0x'");
	    } else {
		    zadd_rdata_wireformat(zparser_conv_hex(parser->region, yyvsp[-1].data.str + 2, yyvsp[-1].data.len - 2)); /* NSAP */
	    }
    }
break;
case 184:
#line 746 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-5].data.str)); /* preference */
	    zadd_rdata_domain(yyvsp[-3].domain); /* MAP822 */
	    zadd_rdata_domain(yyvsp[-1].domain); /* MAPX400 */
    }
break;
case 185:
#line 754 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_aaaa(parser->region, yyvsp[-1].data.str));  /* IPv6 address */
    }
break;
case 186:
#line 760 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_loc(parser->region, yyvsp[-1].data.str)); /* Location */
    }
break;
case 187:
#line 766 "./zparser.y"
{
	    zadd_rdata_domain(yyvsp[-3].domain); /* nxt name */
	    zadd_rdata_wireformat(zparser_conv_nxt(parser->region, nxtbits)); /* nxt bitlist */
	    memset(nxtbits, 0, sizeof(nxtbits));
    }
break;
case 188:
#line 774 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-7].data.str)); /* prio */
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-5].data.str)); /* weight */
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str)); /* port */
	    zadd_rdata_domain(yyvsp[-1].domain); /* target name */
    }
break;
case 189:
#line 784 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-11].data.str)); /* order */
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-9].data.str)); /* preference */
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-7].data.str, yyvsp[-7].data.len)); /* flags */
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-5].data.str, yyvsp[-5].data.len)); /* service */
	    zadd_rdata_wireformat(zparser_conv_text(parser->region, yyvsp[-3].data.str, yyvsp[-3].data.len)); /* regexp */
	    zadd_rdata_domain(yyvsp[-1].domain); /* target name */
    }
break;
case 190:
#line 796 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str)); /* preference */
	    zadd_rdata_domain(yyvsp[-1].domain); /* exchanger */
    }
break;
case 191:
#line 804 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_certificate_type(parser->region, yyvsp[-7].data.str)); /* type */
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-5].data.str)); /* key tag */
	    zadd_rdata_wireformat(zparser_conv_algorithm(parser->region, yyvsp[-3].data.str)); /* algorithm */
	    zadd_rdata_wireformat(zparser_conv_b64(parser->region, yyvsp[-1].data.str)); /* certificate or CRL */
    }
break;
case 193:
#line 817 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_apl_rdata(parser->region, yyvsp[0].data.str));
    }
break;
case 194:
#line 821 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_apl_rdata(parser->region, yyvsp[0].data.str));
    }
break;
case 195:
#line 827 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-7].data.str)); /* keytag */
	    zadd_rdata_wireformat(zparser_conv_algorithm(parser->region, yyvsp[-5].data.str)); /* alg */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-3].data.str)); /* type */
	    zadd_rdata_wireformat(zparser_conv_hex(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* hash */
    }
break;
case 196:
#line 836 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-7].data.str)); /* keytag */
	    zadd_rdata_wireformat(zparser_conv_algorithm(parser->region, yyvsp[-5].data.str)); /* alg */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-3].data.str)); /* type */
	    zadd_rdata_wireformat(zparser_conv_hex(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* hash */
    }
break;
case 197:
#line 845 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-5].data.str)); /* alg */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-3].data.str)); /* fp type */
	    zadd_rdata_wireformat(zparser_conv_hex(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* hash */
    }
break;
case 198:
#line 853 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_b64(parser->region, yyvsp[-1].data.str)); /* data blob */
    }
break;
case 199:
#line 859 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_rrtype(parser->region, yyvsp[-17].data.str)); /* rr covered */
	    zadd_rdata_wireformat(zparser_conv_algorithm(parser->region, yyvsp[-15].data.str)); /* alg */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-13].data.str)); /* # labels */
	    zadd_rdata_wireformat(zparser_conv_period(parser->region, yyvsp[-11].data.str)); /* # orig TTL */
	    zadd_rdata_wireformat(zparser_conv_time(parser->region, yyvsp[-9].data.str)); /* sig exp */
	    zadd_rdata_wireformat(zparser_conv_time(parser->region, yyvsp[-7].data.str)); /* sig inc */
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-5].data.str)); /* key id */
	    zadd_rdata_wireformat(zparser_conv_dns_name(parser->region, 
				(const uint8_t*) yyvsp[-3].data.str,yyvsp[-3].data.len)); /* sig name */
	    zadd_rdata_wireformat(zparser_conv_b64(parser->region, yyvsp[-1].data.str)); /* sig data */
    }
break;
case 200:
#line 874 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_dns_name(parser->region, 
				(const uint8_t*) yyvsp[-1].data.str, yyvsp[-1].data.len)); /* nsec name */
	    zadd_rdata_wireformat(zparser_conv_nsec(parser->region, nsecbits)); /* nsec bitlist */
	    memset(nsecbits, 0, sizeof(nsecbits));
            nsec_highest_rcode = 0;
    }
break;
case 201:
#line 884 "./zparser.y"
{
#ifdef NSEC3
	    nsec3_add_params(yyvsp[-9].data.str, yyvsp[-7].data.str, yyvsp[-5].data.str, yyvsp[-3].data.str, yyvsp[-3].data.len);

	    zadd_rdata_wireformat(zparser_conv_b32(parser->region, yyvsp[-1].data.str)); /* next hashed name */
	    zadd_rdata_wireformat(zparser_conv_nsec(parser->region, nsecbits)); /* nsec bitlist */
	    memset(nsecbits, 0, sizeof(nsecbits));
	    nsec_highest_rcode = 0;
#else
	    zc_error_prev_line("nsec3 not supported");
#endif /* NSEC3 */
    }
break;
case 202:
#line 899 "./zparser.y"
{
#ifdef NSEC3
	    nsec3_add_params(yyvsp[-7].data.str, yyvsp[-5].data.str, yyvsp[-3].data.str, yyvsp[-1].data.str, yyvsp[-1].data.len);
#else
	    zc_error_prev_line("nsec3 not supported");
#endif /* NSEC3 */
    }
break;
case 203:
#line 909 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-7].data.str)); /* usage */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-5].data.str)); /* selector */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-3].data.str)); /* matching type */
	    zadd_rdata_wireformat(zparser_conv_hex(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* ca data */
    }
break;
case 204:
#line 918 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-7].data.str)); /* flags */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-5].data.str)); /* proto */
	    zadd_rdata_wireformat(zparser_conv_algorithm(parser->region, yyvsp[-3].data.str)); /* alg */
	    zadd_rdata_wireformat(zparser_conv_b64(parser->region, yyvsp[-1].data.str)); /* hash */
    }
break;
case 205:
#line 927 "./zparser.y"
{
	    const dname_type* name = 0;
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-6].data.str)); /* precedence */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-4].data.str)); /* gateway type */
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-2].data.str)); /* algorithm */
	    switch(atoi(yyvsp[-4].data.str)) {
		case IPSECKEY_NOGATEWAY: 
			zadd_rdata_wireformat(alloc_rdata_init(parser->region, "", 0));
			break;
		case IPSECKEY_IP4:
			zadd_rdata_wireformat(zparser_conv_a(parser->region, yyvsp[0].data.str));
			break;
		case IPSECKEY_IP6:
			zadd_rdata_wireformat(zparser_conv_aaaa(parser->region, yyvsp[0].data.str));
			break;
		case IPSECKEY_DNAME:
			/* convert and insert the dname */
			if(strlen(yyvsp[0].data.str) == 0)
				zc_error_prev_line("IPSECKEY must specify gateway name");
			if(!(name = dname_parse(parser->region, yyvsp[0].data.str)))
				zc_error_prev_line("IPSECKEY bad gateway dname %s", yyvsp[0].data.str);
			if(yyvsp[0].data.str[strlen(yyvsp[0].data.str)-1] != '.')
				name = dname_concatenate(parser->rr_region, name, 
					domain_dname(parser->origin));
			zadd_rdata_wireformat(alloc_rdata_init(parser->region,
				dname_name(name), name->name_size));
			break;
		default:
			zc_error_prev_line("unknown IPSECKEY gateway type");
	    }
    }
break;
case 206:
#line 961 "./zparser.y"
{
	   zadd_rdata_wireformat(zparser_conv_b64(parser->region, yyvsp[-1].data.str)); /* public key */
    }
break;
case 208:
#line 969 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str));  /* preference */
	    zadd_rdata_wireformat(zparser_conv_ilnp64(parser->region, yyvsp[-1].data.str));  /* NodeID */
    }
break;
case 209:
#line 976 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str));  /* preference */
	    zadd_rdata_wireformat(zparser_conv_a(parser->region, yyvsp[-1].data.str));  /* Locator32 */
    }
break;
case 210:
#line 983 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str));  /* preference */
	    zadd_rdata_wireformat(zparser_conv_ilnp64(parser->region, yyvsp[-1].data.str));  /* Locator64 */
    }
break;
case 211:
#line 990 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_short(parser->region, yyvsp[-3].data.str));  /* preference */
	    zadd_rdata_domain(yyvsp[-1].domain);  /* FQDN */
    }
break;
case 212:
#line 997 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_eui(parser->region, yyvsp[-1].data.str, 48));
    }
break;
case 213:
#line 1003 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_eui(parser->region, yyvsp[-1].data.str, 64));
    }
break;
case 214:
#line 1010 "./zparser.y"
{
	    zadd_rdata_wireformat(zparser_conv_byte(parser->region, yyvsp[-5].data.str)); /* Flags */
	    zadd_rdata_wireformat(zparser_conv_tag(parser->region, yyvsp[-3].data.str, yyvsp[-3].data.len)); /* Tag */
	    zadd_rdata_wireformat(zparser_conv_long_text(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len)); /* Value */
    }
break;
case 215:
#line 1018 "./zparser.y"
{
	    /* $2 is the number of octects, currently ignored */
	    yyval.unknown = zparser_conv_hex(parser->region, yyvsp[-1].data.str, yyvsp[-1].data.len);

    }
break;
case 216:
#line 1024 "./zparser.y"
{
	    yyval.unknown = zparser_conv_hex(parser->region, "", 0);
    }
break;
case 217:
#line 1028 "./zparser.y"
{
	    yyval.unknown = zparser_conv_hex(parser->region, "", 0);
    }
break;
#line 2330 "zparser.c"
    }
    yyssp -= yym;
    yystate = *yyssp;
    yyvsp -= yym;
    yym = yylhs[yyn];
    if (yystate == 0 && yym == 0)
    {
#if YYDEBUG
        if (yydebug)
            printf("%sdebug: after reduction, shifting from state 0 to\
 state %d\n", YYPREFIX, YYFINAL);
#endif
        yystate = YYFINAL;
        *++yyssp = YYFINAL;
        *++yyvsp = yyval;
        if (yychar < 0)
        {
            if ((yychar = yylex()) < 0) yychar = 0;
#if YYDEBUG
            if (yydebug)
            {
                yys = 0;
                if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
                if (!yys) yys = "illegal-symbol";
                printf("%sdebug: state %d, reading %d (%s)\n",
                        YYPREFIX, YYFINAL, yychar, yys);
            }
#endif
        }
        if (yychar == 0) goto yyaccept;
        goto yyloop;
    }
    if ((yyn = yygindex[yym]) && (yyn += yystate) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yystate)
        yystate = yytable[yyn];
    else
        yystate = yydgoto[yym];
#if YYDEBUG
    if (yydebug)
        printf("%sdebug: after reduction, shifting from state %d \
to state %d\n", YYPREFIX, *yyssp, yystate);
#endif
    if (yyssp >= yysslim && yygrowstack())
    {
        goto yyoverflow;
    }
    *++yyssp = yystate;
    *++yyvsp = yyval;
    goto yyloop;

yyoverflow:
    yyerror("yacc stack overflow");

yyabort:
    return (1);

yyaccept:
    return (0);
}
